from crawler import Crawler
from Pentesting.vulnerability_tester.vulnerability_tester import VulnerabilityTester
from urllib.parse import urlparse, parse_qs


def main():
    # 시작 URL 지정
    start_url = "http://127.0.0.1/"  # 대상 URL을 여기에 입력
    crawler = Crawler()
    crawler.crawl(start_url)

    # 수집된 URL과 파라미터에 대해 취약점 테스트 수행
    for url in crawler.visited_urls:
        # 각 URL에 대해 GET 파라미터를 추출하여 테스트
        parsed_url = urlparse(url)
        query_params = parse_qs(parsed_url.query)
        VulnerabilityTester.test_vulnerabilities(url, query_params)


if __name__ == "__main__":
    main()
