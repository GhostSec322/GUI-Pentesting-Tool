# vulnerability_tester/vulnerability_tester.py
from os_command_injection import test_os_command_injection
from xxe_injection import test_xxe_injection
from xss import test_xss
from csrf import test_csrf
from file_download import test_file_download
from file_upload import test_file_upload
from parameter_tampering import test_parameter_tampering
from url_access_control import test_url_access_control
from colorama import Fore


def test_vulnerabilities(url, params):
    print(f"Testing vulnerabilities for: {url}")

    if params:
        for param in params.keys():
            os_command_result = test_os_command_injection(url, param)
            print(os_command_result)

            xss_result = test_xss(url, param)
            print(xss_result)

    xxe_result = test_xxe_injection(url)
    print(xxe_result)

    csrf_result = test_csrf(url)
    print(csrf_result)

    file_download_result = test_file_download(url, params)
    print(file_download_result)

    file_upload_result = test_file_upload(url)
    print(file_upload_result)

    param_tampering_result = test_parameter_tampering(url)
    print(param_tampering_result)

    url_access_result = test_url_access_control(url)
    print(url_access_result)
    print("\n" + "=" * 50 + "\n")
