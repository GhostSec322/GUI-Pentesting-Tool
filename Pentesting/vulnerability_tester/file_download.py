# vulnerability_tester/file_download.py
import requests
from colorama import Fore


def test_file_download(url, params):
    if params:
        for param in params.keys():
            payload = "../etc/passwd"
            response = requests.get(url, params={param: payload})
            if "root:x" in response.text:
                return f"{Fore.RED}File Download vulnerability detected on {param}"
    return f"{Fore.GREEN}No File Download vulnerability"
